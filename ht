<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use DB;

class DataController extends Controller
{
    public  function getData(Request $request)
    {
        $cardId = $request->input('card_id');
        $firstName = $request->input('first_name');
        $fatherName = $request->input('father_name');
        $grandFatherName = $request->input('grandfather_name');
        $familyName = $request->input('family_name');
        $pageSize = $request->input('page_size', 10);
        $pageNumber = $request->input('page_number', 1);

        $results = DB::select("EXEC dbo.getAll @CardId = ?, @FirstName = ?, @FatherName = ?, @GrandFatherName = ?, @FamilyName = ?, @PageSize = ?, @PageNumber = ?",
            [
                $cardId,
                $firstName,
                $fatherName,
                $grandFatherName,
                $familyName,
                $pageSize,
                $pageNumber
            ]);

        return response()->json(['data' => $results], 200);
    }
}
